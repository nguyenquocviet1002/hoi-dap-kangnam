<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>doctor_knhd_1_0_0</title>
    <link rel="stylesheet" href="https://huudinh.github.io/assets/sass/lib.min.css">
    <link rel="stylesheet" href="sass/doctor_knhd_1_0_0.min.css">
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-12">
                <!--  -->
                <section class="doctor_knhd_1_0_0">
                    <div class="doctor_knhd_1_0_0__tabs">
                        <div class="doctor_knhd_1_0_0__arrow doctor_knhd_1_0_0__arrow--1"></div>
                        <div class="doctor_knhd_1_0_0__tab active" data-id="0">Bác sĩ da liễu</div>
                        <div class="doctor_knhd_1_0_0__tab" data-id="1">Bác sĩ răng hàm mặt</div>
                        <div class="doctor_knhd_1_0_0__tab" data-id="2">Bác sĩ phẫu thuật thẩm mỹ</div>
                        <div class="doctor_knhd_1_0_0__arrow doctor_knhd_1_0_0__arrow--2"></div>
                    </div>
                    <div class="doctor_knhd_1_0_0__list">
                        <div class="doctor_knhd_1_0_0__scroll">
                            <div class="doctor_knhd_1_0_0__item">
                                <div class="doctor_knhd_1_0_0__avt"><img width="100" height="100" src="images/dr-richard.png" alt=""></div>
                                <div class="doctor_knhd_1_0_0__info">
                                    <div class="doctor_knhd_1_0_0__name">
                                        <p>Tiến sĩ - Bác sĩ</p>
                                        <p class="doctor_knhd_1_0_0__bold">Dr. Richard Huy</p>
                                    </div>
                                    <div class="doctor_knhd_1_0_0__year">20 năm</div>
                                </div>
                                <div class="doctor_knhd_1_0_0__position">Giám đốc chuyên môn</div>
                                <a href="#" class="doctor_knhd_1_0_0__btn">ĐẶT CÂU HỎI</a>
                            </div>
                            <div class="doctor_knhd_1_0_0__item">
                                <div class="doctor_knhd_1_0_0__avt"><img width="100" height="100" src="images/dr-richard.png" alt=""></div>
                                <div class="doctor_knhd_1_0_0__info">
                                    <div class="doctor_knhd_1_0_0__name">
                                        <p>Tiến sĩ - Bác sĩ</p>
                                        <p class="doctor_knhd_1_0_0__bold">Dr. Richard Huy</p>
                                    </div>
                                    <div class="doctor_knhd_1_0_0__year">20 năm</div>
                                </div>
                                <div class="doctor_knhd_1_0_0__position">Giám đốc chuyên môn</div>
                                <a href="#" class="doctor_knhd_1_0_0__btn">ĐẶT CÂU HỎI</a>
                            </div>
                            <div class="doctor_knhd_1_0_0__item">
                                <div class="doctor_knhd_1_0_0__avt"><img width="100" height="100" src="images/dr-richard.png" alt=""></div>
                                <div class="doctor_knhd_1_0_0__info">
                                    <div class="doctor_knhd_1_0_0__name">
                                        <p>Tiến sĩ - Bác sĩ</p>
                                        <p class="doctor_knhd_1_0_0__bold">Dr. Richard Huy</p>
                                    </div>
                                    <div class="doctor_knhd_1_0_0__year">20 năm</div>
                                </div>
                                <div class="doctor_knhd_1_0_0__position">Giám đốc chuyên môn</div>
                                <a href="#" class="doctor_knhd_1_0_0__btn">ĐẶT CÂU HỎI</a>
                            </div>
                        </div>
                    </div>
                </section>
                <!--  -->
            </div>
        </div>
    </div>

    <script>
        const queryDoctor_knhd_1_0_0 = async () => {
            const response = await fetch('https://hoidap.benhvienthammykangnam.vn/wp-json/api/v1/doctor/');
            const data = await response.json();
            const dataConvert =  [[], [], []];
            data.doctor.forEach(item => {
                if(item.group.includes('Bác sĩ da liễu')){
                    dataConvert[0].push(item);
                }
                if(item.group.includes('Bác sĩ răng hàm mặt')){
                    dataConvert[1].push(item);
                }
                if(item.group.includes('Bác sĩ phẫu thuật thẩm mỹ')){
                    dataConvert[2].push(item);
                }
            })
            return dataConvert;
        }        
        
        let dataDoctor_knhd_1_0_0__tab;
        let indexDoctor_knhd_1_0_0__tab = 0;
        const tabsDoctor_knhd_1_0_0__tab = document.querySelectorAll('.doctor_knhd_1_0_0__tab');
        const prevDoctor_knhd_1_0_0__tab = document.querySelector('.doctor_knhd_1_0_0__arrow--1');
        const nextDoctor_knhd_1_0_0__tab = document.querySelector('.doctor_knhd_1_0_0__arrow--2');

        // func hiện item
        const renderDoctor_knhd_1_0_0__tab = () => {
            const data = dataDoctor_knhd_1_0_0__tab[indexDoctor_knhd_1_0_0__tab];
            const html = data.map(item => {
                return `
                <div class="doctor_knhd_1_0_0__item">
                    <div class="doctor_knhd_1_0_0__avt"><img width="100" height="100" src="https://hoidap.benhvienthammykangnam.vn/${item.image}" alt=""></div>
                    <div class="doctor_knhd_1_0_0__info">
                        <div class="doctor_knhd_1_0_0__name">
                            <p>${item.degree}</p>
                            <p class="doctor_knhd_1_0_0__bold">${item.name}</p>
                        </div>
                        <div class="doctor_knhd_1_0_0__year">${item.experience} <br> năm</div>
                    </div>
                    <div class="doctor_knhd_1_0_0__position">${item.position}</div>
                    <a href="#" class="doctor_knhd_1_0_0__btn">ĐẶT CÂU HỎI</a>
                </div>
                `
            })
            document.querySelector('.doctor_knhd_1_0_0__scroll').innerHTML = html.join('');
        }

        // func active tab
        const activeDoctor_knhd_1_0_0__tab = (elm) => {
            tabsDoctor_knhd_1_0_0__tab.forEach(item => {
                item.classList.remove('active');
            });
            elm.classList.add('active');
        }

        // func gán height
        const setHeightDoctor_knhd_1_0_0__tab = () => {
            const elm = document.querySelector('.doctor_knhd_1_0_0');
            elm.style.minHeight = `${elm.clientHeight}px`;
        }

        // active khi click tab
        tabsDoctor_knhd_1_0_0__tab.forEach(tab => {
            tab.addEventListener('click', () => {
                const id = tab.getAttribute('data-id');
                indexDoctor_knhd_1_0_0__tab = id;
                activeDoctor_knhd_1_0_0__tab(tab);
                renderDoctor_knhd_1_0_0__tab();
            })
        });
        // quay về tab trước
        prevDoctor_knhd_1_0_0__tab.addEventListener('click', () => {
            indexDoctor_knhd_1_0_0__tab--;
            if(indexDoctor_knhd_1_0_0__tab < 0) indexDoctor_knhd_1_0_0__tab = tabsDoctor_knhd_1_0_0__tab.length - 1;
            activeDoctor_knhd_1_0_0__tab(tabsDoctor_knhd_1_0_0__tab[indexDoctor_knhd_1_0_0__tab]);
            renderDoctor_knhd_1_0_0__tab();
        });
        // chuyển sang tab sau
        nextDoctor_knhd_1_0_0__tab.addEventListener('click', () => {
            indexDoctor_knhd_1_0_0__tab++;
            if(indexDoctor_knhd_1_0_0__tab >= tabsDoctor_knhd_1_0_0__tab.length) indexDoctor_knhd_1_0_0__tab = 0;
            activeDoctor_knhd_1_0_0__tab(tabsDoctor_knhd_1_0_0__tab[indexDoctor_knhd_1_0_0__tab]);
            renderDoctor_knhd_1_0_0__tab();
        });

        // func move item
        const funcDrag = (element) => {
            let mouseDown = false;
            let startX, scrollLeft;
            const slider = document.querySelector(element);

            const startDragging = (e) => {
                mouseDown = true;
                startX = e.pageX - slider.offsetLeft;
                scrollLeft = slider.scrollLeft;
            }

            const stopDragging = (e) => {
                mouseDown = false;
            }

            const move = (e) => {
                e.preventDefault();
                if (!mouseDown) { return; }
                const x = e.pageX - slider.offsetLeft;
                const scroll = x - startX;
                slider.scrollLeft = scrollLeft - scroll;
            }
            // Add the event listeners
            slider.addEventListener('mousemove', move, false);
            slider.addEventListener('mousedown', startDragging, false);
            slider.addEventListener('mouseup', stopDragging, false);
            slider.addEventListener('mouseleave', stopDragging, false);
        };
        funcDrag('.doctor_knhd_1_0_0__list');

        window.addEventListener('resize', () => {
          setHeightDoctor_knhd_1_0_0__tab(); 
        });

        window.onload = async() => {
            dataDoctor_knhd_1_0_0__tab = await queryDoctor_knhd_1_0_0();
            setHeightDoctor_knhd_1_0_0__tab(); 
        }
    </script>
</body>
</html>